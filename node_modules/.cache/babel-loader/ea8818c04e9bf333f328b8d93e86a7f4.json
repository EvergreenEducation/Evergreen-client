{"ast":null,"code":"'use strict';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nvar RequestClient = require('./RequestClient');\n\nvar tokenStorage = require('./tokenStorage');\n\nvar _getName = function _getName(id) {\n  return id.split('-').map(function (s) {\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  }).join(' ');\n};\n\nmodule.exports = /*#__PURE__*/function (_RequestClient) {\n  _inheritsLoose(Provider, _RequestClient);\n\n  function Provider(uppy, opts) {\n    var _this;\n\n    _this = _RequestClient.call(this, uppy, opts) || this;\n    _this.provider = opts.provider;\n    _this.id = _this.provider;\n    _this.name = _this.opts.name || _getName(_this.id);\n    _this.pluginId = _this.opts.pluginId;\n    _this.tokenKey = \"companion-\" + _this.pluginId + \"-auth-token\";\n    return _this;\n  }\n\n  var _proto = Provider.prototype;\n\n  _proto.headers = function headers() {\n    return Promise.all([_RequestClient.prototype.headers.call(this), this.getAuthToken()]).then(function (_ref) {\n      var headers = _ref[0],\n          token = _ref[1];\n      return _extends({}, headers, {\n        'uppy-auth-token': token\n      });\n    });\n  };\n\n  _proto.onReceiveResponse = function onReceiveResponse(response) {\n    response = _RequestClient.prototype.onReceiveResponse.call(this, response);\n    var plugin = this.uppy.getPlugin(this.pluginId);\n    var oldAuthenticated = plugin.getPluginState().authenticated;\n    var authenticated = oldAuthenticated ? response.status !== 401 : response.status < 400;\n    plugin.setPluginState({\n      authenticated: authenticated\n    });\n    return response;\n  } // @todo(i.olarewaju) consider whether or not this method should be exposed\n  ;\n\n  _proto.setAuthToken = function setAuthToken(token) {\n    return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey, token);\n  };\n\n  _proto.getAuthToken = function getAuthToken() {\n    return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey);\n  };\n\n  _proto.authUrl = function authUrl() {\n    return this.hostname + \"/\" + this.id + \"/connect\";\n  };\n\n  _proto.fileUrl = function fileUrl(id) {\n    return this.hostname + \"/\" + this.id + \"/get/\" + id;\n  };\n\n  _proto.list = function list(directory) {\n    return this.get(this.id + \"/list/\" + (directory || ''));\n  };\n\n  _proto.logout = function logout() {\n    var _this2 = this;\n\n    return this.get(this.id + \"/logout\").then(function (response) {\n      return Promise.all([response, _this2.uppy.getPlugin(_this2.pluginId).storage.removeItem(_this2.tokenKey)]);\n    }).then(function (_ref2) {\n      var response = _ref2[0];\n      return response;\n    });\n  };\n\n  Provider.initPlugin = function initPlugin(plugin, opts, defaultOpts) {\n    plugin.type = 'acquirer';\n    plugin.files = [];\n\n    if (defaultOpts) {\n      plugin.opts = _extends({}, defaultOpts, opts);\n    }\n\n    if (opts.serverUrl || opts.serverPattern) {\n      throw new Error('`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`');\n    }\n\n    if (opts.companionAllowedHosts) {\n      var pattern = opts.companionAllowedHosts; // validate companionAllowedHosts param\n\n      if (typeof pattern !== 'string' && !Array.isArray(pattern) && !(pattern instanceof RegExp)) {\n        throw new TypeError(plugin.id + \": the option \\\"companionAllowedHosts\\\" must be one of string, Array, RegExp\");\n      }\n\n      plugin.opts.companionAllowedHosts = pattern;\n    } else {\n      // does not start with https://\n      if (/^(?!https?:\\/\\/).*$/i.test(opts.companionUrl)) {\n        plugin.opts.companionAllowedHosts = \"https://\" + opts.companionUrl.replace(/^\\/\\//, '');\n      } else {\n        plugin.opts.companionAllowedHosts = opts.companionUrl;\n      }\n    }\n\n    plugin.storage = plugin.opts.storage || tokenStorage;\n  };\n\n  return Provider;\n}(RequestClient);","map":{"version":3,"sources":["/home/devnineteen/Music/evergreen-frontend/node_modules/@uppy/companion-client/lib/Provider.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_inheritsLoose","subClass","superClass","create","constructor","__proto__","RequestClient","require","tokenStorage","_getName","id","split","map","s","charAt","toUpperCase","slice","join","module","exports","_RequestClient","Provider","uppy","opts","_this","provider","name","pluginId","tokenKey","_proto","headers","Promise","all","getAuthToken","then","_ref","token","onReceiveResponse","response","plugin","getPlugin","oldAuthenticated","getPluginState","authenticated","status","setPluginState","setAuthToken","storage","setItem","getItem","authUrl","hostname","fileUrl","list","directory","get","logout","_this2","removeItem","_ref2","initPlugin","defaultOpts","type","files","serverUrl","serverPattern","Error","companionAllowedHosts","pattern","Array","isArray","RegExp","TypeError","test","companionUrl","replace"],"mappings":"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","sourcesContent":["'use strict';\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar RequestClient = require('./RequestClient');\n\nvar tokenStorage = require('./tokenStorage');\n\nvar _getName = function _getName(id) {\n  return id.split('-').map(function (s) {\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  }).join(' ');\n};\n\nmodule.exports = /*#__PURE__*/function (_RequestClient) {\n  _inheritsLoose(Provider, _RequestClient);\n\n  function Provider(uppy, opts) {\n    var _this;\n\n    _this = _RequestClient.call(this, uppy, opts) || this;\n    _this.provider = opts.provider;\n    _this.id = _this.provider;\n    _this.name = _this.opts.name || _getName(_this.id);\n    _this.pluginId = _this.opts.pluginId;\n    _this.tokenKey = \"companion-\" + _this.pluginId + \"-auth-token\";\n    return _this;\n  }\n\n  var _proto = Provider.prototype;\n\n  _proto.headers = function headers() {\n    return Promise.all([_RequestClient.prototype.headers.call(this), this.getAuthToken()]).then(function (_ref) {\n      var headers = _ref[0],\n          token = _ref[1];\n      return _extends({}, headers, {\n        'uppy-auth-token': token\n      });\n    });\n  };\n\n  _proto.onReceiveResponse = function onReceiveResponse(response) {\n    response = _RequestClient.prototype.onReceiveResponse.call(this, response);\n    var plugin = this.uppy.getPlugin(this.pluginId);\n    var oldAuthenticated = plugin.getPluginState().authenticated;\n    var authenticated = oldAuthenticated ? response.status !== 401 : response.status < 400;\n    plugin.setPluginState({\n      authenticated: authenticated\n    });\n    return response;\n  } // @todo(i.olarewaju) consider whether or not this method should be exposed\n  ;\n\n  _proto.setAuthToken = function setAuthToken(token) {\n    return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey, token);\n  };\n\n  _proto.getAuthToken = function getAuthToken() {\n    return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey);\n  };\n\n  _proto.authUrl = function authUrl() {\n    return this.hostname + \"/\" + this.id + \"/connect\";\n  };\n\n  _proto.fileUrl = function fileUrl(id) {\n    return this.hostname + \"/\" + this.id + \"/get/\" + id;\n  };\n\n  _proto.list = function list(directory) {\n    return this.get(this.id + \"/list/\" + (directory || ''));\n  };\n\n  _proto.logout = function logout() {\n    var _this2 = this;\n\n    return this.get(this.id + \"/logout\").then(function (response) {\n      return Promise.all([response, _this2.uppy.getPlugin(_this2.pluginId).storage.removeItem(_this2.tokenKey)]);\n    }).then(function (_ref2) {\n      var response = _ref2[0];\n      return response;\n    });\n  };\n\n  Provider.initPlugin = function initPlugin(plugin, opts, defaultOpts) {\n    plugin.type = 'acquirer';\n    plugin.files = [];\n\n    if (defaultOpts) {\n      plugin.opts = _extends({}, defaultOpts, opts);\n    }\n\n    if (opts.serverUrl || opts.serverPattern) {\n      throw new Error('`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`');\n    }\n\n    if (opts.companionAllowedHosts) {\n      var pattern = opts.companionAllowedHosts; // validate companionAllowedHosts param\n\n      if (typeof pattern !== 'string' && !Array.isArray(pattern) && !(pattern instanceof RegExp)) {\n        throw new TypeError(plugin.id + \": the option \\\"companionAllowedHosts\\\" must be one of string, Array, RegExp\");\n      }\n\n      plugin.opts.companionAllowedHosts = pattern;\n    } else {\n      // does not start with https://\n      if (/^(?!https?:\\/\\/).*$/i.test(opts.companionUrl)) {\n        plugin.opts.companionAllowedHosts = \"https://\" + opts.companionUrl.replace(/^\\/\\//, '');\n      } else {\n        plugin.opts.companionAllowedHosts = opts.companionUrl;\n      }\n    }\n\n    plugin.storage = plugin.opts.storage || tokenStorage;\n  };\n\n  return Provider;\n}(RequestClient);"]},"metadata":{},"sourceType":"script"}