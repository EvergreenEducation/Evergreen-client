{"ast":null,"code":"import _objectSpread from \"/home/devnineteen/Desktop/Projects/Evergreen-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/devnineteen/Desktop/Projects/Evergreen-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/devnineteen/Desktop/Projects/Evergreen-client/src/components/promotion/PromotionContainer.js\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport React, { useState, useEffect } from 'react';\nimport { Layout, Button, Empty, Popover, Switch, Row, Col } from 'antd';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faFilter } from '@fortawesome/free-solid-svg-icons';\nimport matchSorter from 'match-sorter';\nimport useAxios, { configure } from 'axios-hooks';\nimport axiosInstance from 'services/AxiosInstance';\nimport { LogOutTopbar, SearchHeader, TitleDivider } from 'components/shared';\nimport useGlobalStore from 'store/GlobalStore';\nimport PromoteCard from 'components/promotion/PromoteCard/PromoteCard';\nconfigure({\n  axios: axiosInstance\n});\nconst Content = Layout.Content;\n\nconst _default = function _default(props) {\n  const session = props.session;\n  const adminId = session.id;\n\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        searchString = _useState2[0],\n        setSearchString = _useState2[1];\n\n  const _useState3 = useState(true),\n        _useState4 = _slicedToArray(_useState3, 2),\n        showPromoted = _useState4[0],\n        setShowPromoted = _useState4[1];\n\n  const _useState5 = useState({\n    offer: true,\n    pathway: true,\n    provider: true\n  }),\n        _useState6 = _slicedToArray(_useState5, 2),\n        filters = _useState6[0],\n        setFilters = _useState6[1];\n\n  const _useGlobalStore = useGlobalStore(),\n        providerStore = _useGlobalStore.provider,\n        pathwayStore = _useGlobalStore.pathway,\n        offerStore = _useGlobalStore.offer;\n\n  const _useAxios = useAxios('/pathways?scope=with_files'),\n        _useAxios2 = _slicedToArray(_useAxios, 1),\n        getPathways = _useAxios2[0].data;\n\n  const _useAxios3 = useAxios('/offers?scope=with_files'),\n        _useAxios4 = _slicedToArray(_useAxios3, 1),\n        getOffers = _useAxios4[0].data;\n\n  const _useAxios5 = useAxios('/providers?scope=with_files'),\n        _useAxios6 = _slicedToArray(_useAxios5, 1),\n        getProviders = _useAxios6[0].data;\n\n  const offers = Object.values(offerStore.entities).map(o => {\n    return _objectSpread(_objectSpread({}, o), {}, {\n      entity_type: 'offer'\n    });\n  });\n  const providers = Object.values(providerStore.entities).map(p => {\n    return _objectSpread(_objectSpread({}, p), {}, {\n      entity_type: 'provider'\n    });\n  });\n  const pathways = Object.values(pathwayStore.entities).map(p => {\n    return _objectSpread(_objectSpread({}, p), {}, {\n      entity_type: 'pathway'\n    });\n  });\n  const data = [...offers, ...pathways, ...providers];\n\n  function toggleFilter(key = 'offer') {\n    setFilters(_objectSpread(_objectSpread({}, filters), {}, {\n      [key]: !filters[key]\n    }));\n  }\n\n  function filterContent() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-between mb-1\",\n      gutter: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }\n    }, \"Providers\"), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      size: \"small\",\n      defaultChecked: filters.provider,\n      onClick: () => toggleFilter('provider'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-between mb-1\",\n      gutter: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }\n    }, \"Offers\"), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      size: \"small\",\n      defaultChecked: filters.offer,\n      onClick: () => toggleFilter('offer'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-between\",\n      gutter: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }\n    }, \"Pathways\"), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      size: \"small\",\n      defaultChecked: filters.pathway,\n      onClick: () => toggleFilter('pathway'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n  const handleDataSearch = searchVal => {\n    return setSearchString(searchVal);\n  };\n\n  const handleOnChange = event => {\n    if (showPromoted) {\n      setShowPromoted(false);\n    }\n\n    if (event.target.value.length === 0) {\n      setShowPromoted(true);\n    }\n\n    setSearchString(event.target.value);\n  };\n\n  const handleDataAfterSearch = (data, keys = ['name', 'keywords']) => {\n    return matchSorter(data, searchString, {\n      keys\n    });\n  };\n\n  let showData = handleDataAfterSearch(data);\n\n  if (showPromoted) {\n    showData = showData.filter(d => {\n      if (filters.offer && d.entity_type === 'offer' && (d.is_main_promo || d.is_local_promo)) {\n        return true;\n      }\n\n      if (filters.provider && d.entity_type === 'provider' && (d.is_main_promo || d.is_local_promo)) {\n        return true;\n      }\n\n      if (filters.pathway && d.entity_type === 'pathway' && (d.is_main_promo || d.is_local_promo)) {\n        return true;\n      }\n\n      return false;\n    });\n  } else {\n    showData = showData.filter(d => {\n      if (filters.offer && d.entity_type === 'offer') {\n        return true;\n      }\n\n      if (filters.provider && d.entity_type === 'provider') {\n        return true;\n      }\n\n      if (filters.pathway && d.entity_type === 'pathway') {\n        return true;\n      }\n\n      return false;\n    });\n  }\n\n  useEffect(() => {\n    if (getPathways) {\n      pathwayStore.addMany(getPathways);\n    }\n\n    if (getOffers) {\n      offerStore.addMany(getOffers);\n    }\n\n    if (getProviders) {\n      providerStore.addMany(getProviders);\n    }\n  }, [getPathways, getOffers, getProviders]);\n  return /*#__PURE__*/React.createElement(Layout, {\n    className: \"bg-transparent h-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(LogOutTopbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(SearchHeader, {\n    title: \"PROMOTIONS\",\n    onSearch: handleDataSearch,\n    onChange: handleOnChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Popover, {\n    content: filterContent,\n    trigger: \"click\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    className: \"rounded ml-1 px-4 text-center\",\n    type: \"primary\",\n    size: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    className: \"text-white text-xs\",\n    icon: faFilter,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }\n  }))))), /*#__PURE__*/React.createElement(Content, {\n    className: \"p-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TitleDivider, {\n    title: \"My Promotions\",\n    styles: {\n      leftContainer: {\n        backgroundColor: '#4a5568'\n      },\n      rightContainer: {\n        backgroundColor: '#4a5568'\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shadow-md rounded-md w-full bg-white h-full pt-4 px-5 flex flex-wrap mb-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 9\n    }\n  }, showData.length && showData.filter(function ({\n    main_promoted_by_user_ids,\n    local_promoted_by_user_ids\n  }) {\n    return main_promoted_by_user_ids.includes(adminId) || local_promoted_by_user_ids.includes(adminId);\n  }).map((d, index) => {\n    return /*#__PURE__*/React.createElement(PromoteCard, {\n      key: index,\n      data: d,\n      session: session,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 24\n      }\n    });\n  }) || /*#__PURE__*/React.createElement(Empty, {\n    className: \"m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 22\n    }\n  })), /*#__PURE__*/React.createElement(TitleDivider, {\n    title: \"Other Promotions\\t& Search Results\",\n    styles: {\n      leftContainer: {\n        backgroundColor: '#4a5568'\n      },\n      rightContainer: {\n        backgroundColor: '#4a5568'\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    className: \"shadow-md rounded-md w-full bg-white h-full pt-4 px-5 flex flex-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }\n  }, showData.length && showData.map((d, index) => {\n    return /*#__PURE__*/React.createElement(PromoteCard, {\n      key: index,\n      data: d,\n      session: session,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 22\n      }\n    });\n  }) || /*#__PURE__*/React.createElement(Empty, {\n    className: \"m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 20\n    }\n  }))));\n};\n\n__signature__(_default, \"useState{[searchString, setSearchString]('')}\\nuseState{[showPromoted, setShowPromoted](true)}\\nuseState{[filters, setFilters]({\\r\\n    offer: true,\\r\\n    pathway: true,\\r\\n    provider: true,\\r\\n  })}\\nuseGlobalStore{{\\r\\n    provider: providerStore,\\r\\n    pathway: pathwayStore,\\r\\n    offer: offerStore,\\r\\n  }}\\nuseAxios{[{ data: getPathways }]}\\nuseAxios{[{ data: getOffers }]}\\nuseAxios{[{ data: getProviders }]}\\nuseEffect{}\", () => [useGlobalStore, useAxios, useAxios, useAxios]);\n\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(Content, \"Content\", \"/home/devnineteen/Desktop/Projects/Evergreen-client/src/components/promotion/PromotionContainer.js\");\n  reactHotLoader.register(_default, \"default\", \"/home/devnineteen/Desktop/Projects/Evergreen-client/src/components/promotion/PromotionContainer.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/home/devnineteen/Desktop/Projects/Evergreen-client/src/components/promotion/PromotionContainer.js"],"names":["React","useState","useEffect","Layout","Button","Empty","Popover","Switch","Row","Col","FontAwesomeIcon","faFilter","matchSorter","useAxios","configure","axiosInstance","LogOutTopbar","SearchHeader","TitleDivider","useGlobalStore","PromoteCard","axios","Content","props","session","adminId","id","searchString","setSearchString","showPromoted","setShowPromoted","offer","pathway","provider","filters","setFilters","providerStore","pathwayStore","offerStore","getPathways","data","getOffers","getProviders","offers","Object","values","entities","map","o","entity_type","providers","p","pathways","toggleFilter","key","filterContent","handleDataSearch","searchVal","handleOnChange","event","target","value","length","handleDataAfterSearch","keys","showData","filter","d","is_main_promo","is_local_promo","addMany","leftContainer","backgroundColor","rightContainer","main_promoted_by_user_ids","local_promoted_by_user_ids","includes","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Layout, Button, Empty, Popover, Switch, Row, Col } from 'antd';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faFilter } from '@fortawesome/free-solid-svg-icons';\r\nimport matchSorter from 'match-sorter';\r\nimport useAxios, { configure } from 'axios-hooks';\r\nimport axiosInstance from 'services/AxiosInstance';\r\nimport { LogOutTopbar, SearchHeader, TitleDivider } from 'components/shared';\r\nimport useGlobalStore from 'store/GlobalStore';\r\nimport PromoteCard from 'components/promotion/PromoteCard/PromoteCard';\r\n\r\nconfigure({\r\n  axios: axiosInstance,\r\n});\r\n\r\nconst { Content } = Layout;\r\n\r\nexport default function (props) {\r\n  const { session } = props;\r\n  const adminId = session.id;\r\n  const [searchString, setSearchString] = useState('');\r\n  const [showPromoted, setShowPromoted] = useState(true);\r\n  const [filters, setFilters] = useState({\r\n    offer: true,\r\n    pathway: true,\r\n    provider: true,\r\n  });\r\n  const {\r\n    provider: providerStore,\r\n    pathway: pathwayStore,\r\n    offer: offerStore,\r\n  } = useGlobalStore();\r\n\r\n  const [{ data: getPathways }] = useAxios('/pathways?scope=with_files');\r\n\r\n  const [{ data: getOffers }] = useAxios('/offers?scope=with_files');\r\n\r\n  const [{ data: getProviders }] = useAxios('/providers?scope=with_files');\r\n\r\n  const offers = Object.values(offerStore.entities).map((o) => {\r\n    return {\r\n      ...o,\r\n      entity_type: 'offer',\r\n    };\r\n  });\r\n\r\n  const providers = Object.values(providerStore.entities).map((p) => {\r\n    return {\r\n      ...p,\r\n      entity_type: 'provider',\r\n    };\r\n  });\r\n\r\n  const pathways = Object.values(pathwayStore.entities).map((p) => {\r\n    return {\r\n      ...p,\r\n      entity_type: 'pathway',\r\n    };\r\n  });\r\n\r\n  const data = [...offers, ...pathways, ...providers];\r\n\r\n  function toggleFilter(key = 'offer') {\r\n    setFilters({\r\n      ...filters,\r\n      [key]: !filters[key],\r\n    });\r\n  }\r\n\r\n  function filterContent() {\r\n    return (\r\n      <div>\r\n        <Row className=\"justify-between mb-1\" gutter={6}>\r\n          <Col>Providers</Col>\r\n          <Col>\r\n            <Switch\r\n              size=\"small\"\r\n              defaultChecked={filters.provider}\r\n              onClick={() => toggleFilter('provider')}\r\n            />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"justify-between mb-1\" gutter={6}>\r\n          <Col>Offers</Col>\r\n          <Col>\r\n            <Switch\r\n              size=\"small\"\r\n              defaultChecked={filters.offer}\r\n              onClick={() => toggleFilter('offer')}\r\n            />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"justify-between\" gutter={6}>\r\n          <Col>Pathways</Col>\r\n          <Col>\r\n            <Switch\r\n              size=\"small\"\r\n              defaultChecked={filters.pathway}\r\n              onClick={() => toggleFilter('pathway')}\r\n            />\r\n          </Col>\r\n        </Row>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleDataSearch = (searchVal) => {\r\n    return setSearchString(searchVal);\r\n  };\r\n\r\n  const handleOnChange = (event) => {\r\n    if (showPromoted) {\r\n      setShowPromoted(false);\r\n    }\r\n    if (event.target.value.length === 0) {\r\n      setShowPromoted(true);\r\n    }\r\n    setSearchString(event.target.value);\r\n  };\r\n\r\n  const handleDataAfterSearch = (data, keys = ['name', 'keywords']) => {\r\n    return matchSorter(data, searchString, { keys });\r\n  };\r\n\r\n  let showData = handleDataAfterSearch(data);\r\n\r\n  if (showPromoted) {\r\n    showData = showData.filter((d) => {\r\n      if (\r\n        filters.offer &&\r\n        d.entity_type === 'offer' &&\r\n        (d.is_main_promo || d.is_local_promo)\r\n      ) {\r\n        return true;\r\n      }\r\n\r\n      if (\r\n        filters.provider &&\r\n        d.entity_type === 'provider' &&\r\n        (d.is_main_promo || d.is_local_promo)\r\n      ) {\r\n        return true;\r\n      }\r\n\r\n      if (\r\n        filters.pathway &&\r\n        d.entity_type === 'pathway' &&\r\n        (d.is_main_promo || d.is_local_promo)\r\n      ) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n  } else {\r\n    showData = showData.filter((d) => {\r\n      if (filters.offer && d.entity_type === 'offer') {\r\n        return true;\r\n      }\r\n\r\n      if (filters.provider && d.entity_type === 'provider') {\r\n        return true;\r\n      }\r\n\r\n      if (filters.pathway && d.entity_type === 'pathway') {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (getPathways) {\r\n      pathwayStore.addMany(getPathways);\r\n    }\r\n    if (getOffers) {\r\n      offerStore.addMany(getOffers);\r\n    }\r\n    if (getProviders) {\r\n      providerStore.addMany(getProviders);\r\n    }\r\n  }, [getPathways, getOffers, getProviders]);\r\n\r\n  return (\r\n    <Layout className=\"bg-transparent h-auto\">\r\n      <LogOutTopbar>\r\n        <SearchHeader\r\n          title=\"PROMOTIONS\"\r\n          onSearch={handleDataSearch}\r\n          onChange={handleOnChange}\r\n        >\r\n          <Popover content={filterContent} trigger=\"click\">\r\n            <Button\r\n              className=\"rounded ml-1 px-4 text-center\"\r\n              type=\"primary\"\r\n              size=\"small\"\r\n            >\r\n              <FontAwesomeIcon className=\"text-white text-xs\" icon={faFilter} />\r\n            </Button>\r\n          </Popover>\r\n        </SearchHeader>\r\n      </LogOutTopbar>\r\n      <Content className=\"p-6\">\r\n        <TitleDivider\r\n          title=\"My Promotions\"\r\n          styles={{\r\n            leftContainer: {\r\n              backgroundColor: '#4a5568',\r\n            },\r\n            rightContainer: {\r\n              backgroundColor: '#4a5568',\r\n            },\r\n          }}\r\n        />\r\n        <div className=\"shadow-md rounded-md w-full bg-white h-full pt-4 px-5 flex flex-wrap mb-1\">\r\n          {(showData.length &&\r\n            showData\r\n              .filter(function ({\r\n                main_promoted_by_user_ids,\r\n                local_promoted_by_user_ids,\r\n              }) {\r\n                return (\r\n                  main_promoted_by_user_ids.includes(adminId) ||\r\n                  local_promoted_by_user_ids.includes(adminId)\r\n                );\r\n              })\r\n              .map((d, index) => {\r\n                return <PromoteCard key={index} data={d} session={session} />;\r\n              })) || <Empty className=\"m-auto\" />}\r\n        </div>\r\n        <TitleDivider\r\n          title=\"Other Promotions\t&amp; Search Results\"\r\n          styles={{\r\n            leftContainer: {\r\n              backgroundColor: '#4a5568',\r\n            },\r\n            rightContainer: {\r\n              backgroundColor: '#4a5568',\r\n            },\r\n          }}\r\n        />\r\n        <main className=\"shadow-md rounded-md w-full bg-white h-full pt-4 px-5 flex flex-wrap\">\r\n          {(showData.length &&\r\n            showData.map((d, index) => {\r\n              return <PromoteCard key={index} data={d} session={session} />;\r\n            })) || <Empty className=\"m-auto\" />}\r\n        </main>\r\n      </Content>\r\n    </Layout>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}